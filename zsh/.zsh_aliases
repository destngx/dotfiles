# use nvim, but don't make me think about it
if [[ -n "$(command -v nvim)" ]]; then
  alias vim="nvim"
  alias v="nvim"
  if [[ -n "$(command -v fzf)" ]]; then
    alias vf='nvim $(fzf)'
  fi
fi

if [[ -n "$(command -v microk8s)" ]]; then
    alias m="microk8s"
    alias mk="microk8s.kubectl"
fi

if [[ -n "$(command -v eza)" ]]; then
  alias l="eza"
  alias ls="eza --icons"
  alias la="eza -la --icons"
  alias lt="ls --tree --level=3"
fi

if [[ -n "$(command -v tmux)" ]]; then
  alias t="tmux"
  alias ta="t a -t"
  alias tls="t ls"
  alias tn="t new -t"
fi

if [[ -n "$(command -v bat)" ]]; then
  alias cat=bat
fi
if [[ -n "$(command -v batcat)" ]]; then
  alias cat=batcat
fi

if [[ -n "$(command -v pnpm)" ]]; then
  alias pn=pnpm
  alias px=pnpx
fi

if [[ -n "$(command -v kubectl)" ]]; then
  alias k=kubectl
fi

if [[ -n "$(command -v helm)" ]]; then
  alias h=helm
fi

if [[ -n "$(command -v terraform)" ]]; then
  alias t=terraform
  alias ti="terraform init"
  alias tp="terraform plan"
  alias ta="terraform apply"
  alias ts="terraform show"
fi

if [[ -n "$(command -v tofu)" ]]; then
  alias t=tofu
  alias ti="tofu init"
  alias tp="tofu plan"
  alias ta="tofu apply"
fi

if [[ -n "$(command -v bun)" ]]; then
  alias b=bun
  alias bi=bun install
fi

if [[ -n "$(command -v nnn)" ]]; then
  alias n=nnn
fi

if [[ -n "$(command -v fzf)" ]]; then
  alias cf='cd $(fd . --type d | fzf)'
fi

# Useful aliases

alias redo='sudo !!'
alias py=python3
alias python=python3
alias ...='cd ../../'
alias ....='cd ../../../'

# Git aliases

alias g="git"
alias gst="g st"
alias gpl="g pl"
alias gps="g pl && g ps"
alias ghist="g hist"
alias gca="g ca"
alias gci="g ci"

# Copy my public key to my clipboard - interactive selection for multiple keys
pubkey() {
  local ssh_dir="$HOME/.ssh"
  local selected_key
  
  # Check if fzf is available
  if [[ -z "$(command -v fzf)" ]]; then
    echo "Error: fzf is not installed. Please install fzf for key selection."
    return 1
  fi
  
  # Find all .pub files in ~/.ssh
  if [[ -n "$(command -v fd)" ]]; then
    selected_key=$(fd -e pub . "$ssh_dir" --type f | fzf --prompt="Select SSH public key: " --height=40% --border)
  else
    selected_key=$(find "$ssh_dir" -maxdepth 1 -name "*.pub" -type f | fzf --prompt="Select SSH public key: " --height=40% --border)
  fi
  
  # Check if a key was selected
  if [[ -z "$selected_key" ]]; then
    echo "No key selected."
    return 1
  fi
  
  # Copy the selected key to clipboard
  if cat "$selected_key" | pbcopy; then
    echo "=> Public key '$(basename "$selected_key")' copied to pasteboard."
  else
    echo "Error: Failed to copy key to clipboard."
    return 1
  fi
}
